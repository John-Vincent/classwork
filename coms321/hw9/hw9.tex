\documentclass[11pt]{article}
\usepackage{mathtools}
\usepackage{mdframed}
\usepackage{fullpage}
\usepackage{amsfonts}
\usepackage{tikz}
\usepackage{fancyhdr}
\usepackage{lastpage}


%edit this for each class
\newcommand\name{John Collin Vincent}
\newcommand\classname{Com S 321}
\newcommand\assignment{Homework 9}


\newcounter{excounter}
\setcounter{excounter}{1}

\newcommand\ques[2]{\vskip 1em  \noindent\textbf{\arabic{excounter}\addtocounter{excounter}{1}.} \emph{#1} \noindent#2}
\newenvironment{question}{\ques{}\begin{quote}}{\end{quote}}
\newenvironment{subquestion}[1]{#1) \begin{quote}}{\end{quote}}

\pagestyle{fancy}
\rfoot{\name, page \thepage/\pageref{LastPage}}
\cfoot{}
\rhead{}
\lhead{}
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}
\DeclarePairedDelimiter\ceil{\lceil}{\rceil}
\DeclarePairedDelimiter\floor{\lfloor}{\rfloor}


\begin{document}


  {\bf \classname \hspace{1cm} \assignment\hfill \name}
  \vskip 2em


  \begin{question}
    \begin{align*}
      8M &= 2^3 * 20^{20}\\
         &= 2^{23} \text{ words}\\
     64K &= 2^6 * 2^{10}\\
         &= 2^{16} \text{ words}\\
    \end{align*}
    \begin{subquestion}{a}
      \vspace{-.5cm}
      \begin{align*}
        \text{block size} &= 32 = 2^5 \text{ words}\\
        \text{frames in cache} &= \frac{2^{16}}{2^5}\\
                               &= 2^{11} = 11\text{ bits for block frame \#}
      \end{align*}
      \centering
      \begin{tabular}{|c | c | c|}
        \hline
        \multicolumn{3}{|c|}{23 bits}\\
        \hline
        TAG    & BlockFrame \# & Offset\\
        \hline
        7 bits & 11 bits       &  5 bits\\
        \hline
      \end{tabular}
    \end{subquestion}
    \begin{subquestion}{b}
      \centering
      \begin{tabular}{| c | c |}
        \hline
        \multicolumn{2}{|c|}{23 bits}\\
        \hline
        TAG    & Offset\\
        \hline
        $23-m$ bits &  m bits\\
        \hline
      \end{tabular}
    \end{subquestion}
    \begin{subquestion}{c}
      \begin{align*}
        \text{number of BF's} &= \frac{2^{16}}{2^6}\\
                              &= 2^{10}\\
        \text{number of sets} &= \frac{\text{number of BF's}}{\text{set size}}\\
                              &= \frac{2^{10}}{2^{2}}\\
                              &= 2^{8}
      \end{align*}\centering
      \begin{tabular}{|c | c | c|}
        \hline
        \multicolumn{3}{|c|}{23 bits}\\
        \hline
        TAG    & Set \# & Offset\\
        \hline
        9 bits & 8 bits       &  6 bits\\
        \hline
      \end{tabular}
    \end{subquestion}
  \end{question}

  \begin{question}
    \begin{align*}
      \text{BF's in cache} &= 8\\
                           &= 2^3\\
      \text{BF offset}    &= 16\\
                          &= 2^4\\
      \text{address size} &= 2^{4} * 2^{6}\\
                          &= 2^{10}
    \end{align*}
    \begin{subquestion}{a}
      \centering
      \begin{tabular}{|c | c | c|}
        \hline
        \multicolumn{3}{|c|}{10 bits}\\
        \hline
        TAG    & BF \# & Offset\\
        \hline
        $10-3-4= 3$ bits & 3 bits       &  4 bits\\
        \hline
      \end{tabular}
    \end{subquestion}
    \begin{subquestion}{b}
      $0\text{x}37\text{A} = 1101111010$
      since we have tag $110$ in frame $7$ we know that this word will be in cache because the block $110 111$ is in cache.
    \end{subquestion}
    \begin{subquestion}{c}
      $0\text{x}22\text{C} = 1000101100$
      since we have tag $100$ in frame $2$ we know that this word will be in cache because the block $100 010$ is in cache.
    \end{subquestion}
    \begin{subquestion}{c}
      $0\text{x}1\text{B}9 = 0110111001$
      since we have tag $010$ in frame $3$ we know that this word will not be in cache because the block $011 011$ is not in cache.
    \end{subquestion}
  \end{question}

  \begin{question}
    \begin{align*}
      \text{number of BF's} &= 8\\
                            &= 2^{3}\\
      \text{number of sets} &= \frac{\text{number of BF's}}{\text{set size}}\\
                            &= \frac{2^{3}}{2^{1}}\\
                            &= 2^{2}
    \end{align*}
    \begin{subquestion}{a}
      \centering
      \begin{tabular}{|c | c | c|}
        \hline
        \multicolumn{3}{|c|}{10 bits}\\
        \hline
        TAG    & Set \# & Offset\\
        \hline
        $10-2-4= 4$ bits & 2 bits &  4 bits\\
        \hline
      \end{tabular}
    \end{subquestion}
    \begin{subquestion}{b}
      $0\text{x}37\text{A} = 1101111010$
      since we have tag $1101$ in a set $3$ spot we know that this word will be in cache because the block $1101 11$ is in cache.
    \end{subquestion}
    \begin{subquestion}{c}
      $0\text{x}22\text{C} = 1000101100$
      since we have tag $1000$ in a set $2$ spot we know that this word will be in cache because the block $1000 10$ is in cache.
    \end{subquestion}
    \begin{subquestion}{c}
      $0\text{x}1\text{B}9 = 0110111001$
      since we have tag $0110$ in a set $3$ spot we know that this word will be in cache because the block $0110 11$ is in cache.
    \end{subquestion}
  \end{question}

  \begin{question}
    \begin{align*}
      1M &= 2^{20} \text{words/address size}
      4K &= 2^{2} * 2^{10} = 2^{12} \text{words/cache size}
      \text{BF's in cache} &= \frac{2^{12}}{2^{4}} = 2^8
    \end{align*}
    \begin{subquestion}{a}
      \centering
      \begin{tabular}{|c | c | c|}
        \hline
        \multicolumn{3}{|c|}{20 bits}\\
        \hline
        TAG    & BF \# & Offset\\
        \hline
        $20-8-4= 8$ bits & 8 bits &  4 bits\\
        \hline
      \end{tabular}
      $0\text{x}949\text{DA} = 10010100100111011010$\\
      cache frame $= 1001 1101 = 157$\\
      tag $= 1001 0100 = 148$
    \end{subquestion}
    \begin{subquestion}{b}
      \[ \text{number of sets} = 64 = 2^6 \]
      \centering
      \begin{tabular}{|c | c | c|}
        \hline
        \multicolumn{3}{|c|}{20 bits}\\
        \hline
        TAG    & Set \# & Offset\\
        \hline
        $20-6-4= 10$ bits & 6 bits &  4 bits\\
        \hline
      \end{tabular}
      $0\text{x}949\text{DA} = 10010100100111011010$\\
      cache tag $= 10$ bits\\
      tag $= 10 0101 0010 = 252_{8}$
    \end{subquestion}

    \begin{subquestion}{c}
      TAG $= 20 - 4$ bits $= 16$ bits
      TAG $= 0\text{x}949\text{D}$
    \end{subquestion}
  \end{question}
  \clearpage
  \begin{question}
    \begin{align*}
      \text{Main Mem Words/ address bits} &= 2^5 *2^{10}= 2^{15}\\
      \text{BF's in cache} &= \frac{2^2 * 2^{10}\text{ words}}{2^3\text{ block size}}\\
                             &= 2^9\\
    \end{align*}
    \begin{subquestion}{a}
      $2^9$ comparators are needed because there are $2^9$ block frames in cache
    \end{subquestion}
    \begin{subquestion}{b}
      the size of the tag field is $15 - 3 = 12$ because the address is 15 bits long and
      the offset for a block size of $8$ is $3$.
    \end{subquestion}
    \begin{subquestion}{c}
      1 comparator would be needed and the tag size would be $15 - 3 - 9 = 3$ since 9 of the bits
      will be used to notate block frame number
    \end{subquestion}
  \end{question}

  \begin{question}
    \begin{align*}
      \text{Main Mem words} &= 2^3 * 2^{10} * 2^3\\
                            &= 2^16
    \end{align*}
    \begin{subquestion}{a}
      the number of bits in a main memory address is 16 because there are $2^16$ words in main
      memory
    \end{subquestion}
    \begin{subquestion}{b}
      $0\text{xCA}49 = 1100101001001001$ so the 3 bit offset would be $001$.
    \end{subquestion}
    \begin{subquestion}{c}
      since there are 512 BF's in cache there must be $10$ bits that specify BF \#
      $16-10-3 = 3$ so the tag is $3$ bits so the block frame number is $0101001001 = 329$
      there should be 1 hardware comparitor and it should be width $3$ because the tag is $3$ bits.
    \end{subquestion}
    \begin{subquestion}{d}
      if there are $512$ BF's and $4$ frames per set there are $128$ sets in cache.
      so there should be $6$ bits in the set number, $16 - 6 -3 = 7$ so the tag is $7$ bits.
      the set number would be $001001 = 9$. there would need to be 4 comparators, since the
      set size is 4, and the width should be $7$ since the tag is $7$ bits.
    \end{subquestion}
  \end{question}

\end{document}
